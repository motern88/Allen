<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MAS çŠ¶æ€ç›‘æ§</title>
  <!-- å¼•å…¥ Bootstrap æ ·å¼åº“ï¼Œç”¨äºç¾åŒ–æŒ‰é’®å’Œå¸ƒå±€ -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      display: flex;                 /* é¡µé¢å·¦å³å¸ƒå±€ */
      min-height: 100vh;             /* æœ€å°é«˜åº¦ä¸ºè§†å£é«˜åº¦ */
    }
    #sidebar {
      width: 250px;                  /* å·¦ä¾§è¾¹æ å®½åº¦ */
      background-color: #f8f9fa;     /* èƒŒæ™¯è‰²ä¸ºæµ…ç°è‰² */
      padding: 1rem;
      border-right: 1px solid #ddd;  /* æ·»åŠ å³ä¾§è¾¹æ¡†çº¿ */
    }
    #main {
      flex-grow: 1;                  /* ä¸»å†…å®¹åŒºåŸŸå æ®å‰©ä½™ç©ºé—´ */
      padding: 1rem;
      overflow-y: auto;              /* å‚ç›´æ–¹å‘å¯æ»šåŠ¨ */
    }
    .state-card {
      border: 1px solid #ccc;        /* å¡ç‰‡è¾¹æ¡† */
      border-radius: 0.5rem;         /* åœ†è§’ */
      padding: 1rem;
      margin-bottom: 1rem;
      background-color: #ffffff;     /* èƒŒæ™¯ç™½è‰² */
      box-shadow: 0 0 8px rgba(0,0,0,0.05);   /* è½»å¾®é˜´å½± */
    }
    pre {
      white-space: pre-wrap;         /* è‡ªåŠ¨æ¢è¡Œæ˜¾ç¤º JSON */
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <!-- å·¦ä¾§æ§åˆ¶è¾¹æ ï¼šçŠ¶æ€å±‚çº§é€‰æ‹© -->
  <div id="sidebar">
    <h5>æ§åˆ¶è¾¹æ </h5>
    <div class="btn-group-vertical w-100">
      <!-- ç‚¹å‡»æŒ‰é’®åŠ è½½å¯¹åº”çŠ¶æ€ç±»å‹ -->
      <button class="btn btn-outline-primary" onclick="loadState('task')">Task</button>
      <button class="btn btn-outline-primary" onclick="loadState('stage')">Stage</button>
      <button class="btn btn-outline-primary" onclick="loadState('agent')">Agent</button>
      <button class="btn btn-outline-primary" onclick="loadState('step')">Step</button>
    </div>
  </div>

  <!-- å³ä¾§ä¸»å†…å®¹åŒºåŸŸ -->
  <div id="main">
    <h3 id="title">è¯·åœ¨å·¦ä¾§æ§åˆ¶è¾¹æ ä¸­æŸ¥çœ‹ç›¸åº”çŠ¶æ€</h3>
    <div id="stateCards" class="mt-3"></div>
  </div>

  <script>
    /**
     * æ ¹æ®æ‰€é€‰çŠ¶æ€ç±»å‹åŠ è½½çŠ¶æ€ä¿¡æ¯
     * @param {string} type çŠ¶æ€ç±»å‹ï¼Œå¦‚ 'task'ã€'stage' ç­‰
     */
    async function loadState(type) {
      // æ›´æ–°æ ‡é¢˜ä¸ºæ‰€é€‰çŠ¶æ€ç±»å‹
      document.getElementById('title').innerText = `ğŸ“¦ ${type.toUpperCase()} çŠ¶æ€ä¿¡æ¯`;

      // å‘åç«¯è¯·æ±‚çŠ¶æ€æ•°æ®ï¼ˆå‡è®¾åç«¯ API ä¸º /api/states?type=xxxï¼‰
      const res = await fetch(`/api/states?type=${type}`);
      const data = await res.json();

      // æ¸…ç©ºä¹‹å‰çš„çŠ¶æ€å¡ç‰‡å†…å®¹
      const container = document.getElementById('stateCards');
      container.innerHTML = "";

      // éå†çŠ¶æ€å­—å…¸ï¼Œåˆ›å»ºå¡ç‰‡
      Object.entries(data).forEach(([id, state]) => {
        const card = document.createElement("div");
        card.className = "state-card";
        card.innerHTML = `
          <h5>${id}</h5>
          <pre>${JSON.stringify(state, null, 2)}</pre>
        `;
        container.appendChild(card);
      });
    }
  </script>
</body>
</html>